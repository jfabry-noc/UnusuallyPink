<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>infosec on Unusually Pink</title>
    <link>https://unusually.pink/tags/infosec/</link>
    <description>Recent content in infosec on Unusually Pink</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>2021 - John Fabry</copyright>
    <lastBuildDate>Sat, 07 Nov 2020 00:00:00 +0000</lastBuildDate><atom:link href="https://unusually.pink/tags/infosec/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Books: Hands On Hacking</title>
      <link>https://unusually.pink/books-hands-on-hacking/</link>
      <pubDate>Sat, 07 Nov 2020 00:00:00 +0000</pubDate>
      
      <guid>https://unusually.pink/books-hands-on-hacking/</guid>
      <description>While I&amp;rsquo;ve been stuck at home as the global coronavirus pandemic rages on (currently on day 241 of quarantine, for those who listen to the Same Shade Of Difference), I&amp;rsquo;ve been trying to make the most of my time in captivity with lots of reading, training, and personal projects to learn as much new stuff as I can. One of the items that came on to my radar a few months ago was a new infosec book titled Hands On Hacking from Wiley.</description>
      <content>&lt;p&gt;While I&amp;rsquo;ve been stuck at home as the global coronavirus pandemic rages on (currently on day 241 of quarantine, for those who listen to the &lt;a href=&#34;https://sameshadeofdifference.com/&#34;&gt;Same Shade Of Difference&lt;/a&gt;), I&amp;rsquo;ve been trying to make the most of my time in captivity with lots of reading, training, and personal projects to learn as much new stuff as I can. One of the items that came on to my radar a few months ago was a new infosec book titled &lt;em&gt;&lt;a href=&#34;https://www.wiley.com/en-us/Hands+on+Hacking-p-9781119561453&#34;&gt;Hands On Hacking&lt;/a&gt;&lt;/em&gt; from Wiley. Written in part by &lt;a href=&#34;https://twitter.com/hackerfantastic&#34;&gt;Hacker Fantastic&lt;/a&gt;, who I&amp;rsquo;ve followed on Twitter for quite a few years across my various accounts, I figured it would be a good refresher for some of the hacking concepts I&amp;rsquo;ve used before and a primer for newer tooling that I&amp;rsquo;m not as familiar with.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://unusually.pink/images/hands_on_hacking.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;As you can see from the book&amp;rsquo;s cover, the idea is to teach &amp;ldquo;purple teaming&amp;rdquo;, which is the idea of doing away with the silos for the &amp;ldquo;red team&amp;rdquo; that tries to breach systems and the &amp;ldquo;blue team&amp;rdquo; that tries to defend them. The book covers the full gamut of hacking, starting with open source information gathering to get as much data as you can about your target before actively engaging with any of their systems all the way through compromising web applications and moving laterally through internal systems.&lt;/p&gt;
&lt;p&gt;All throughout, the book uses purple teaming as a focus; it very clearly outlines that taking part in any of the activities covered without the express consent of the owners of the system can carry &lt;em&gt;severe&lt;/em&gt; legal penalties. The goal is to assist you with either a career as a penetration tester or to give you the tools and knowledge to be able to pen test and secure your own systems that you manage. You will &lt;em&gt;not&lt;/em&gt; read the book and immediately find yourself living the life of a &lt;em&gt;Mr. Robot&lt;/em&gt; character.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://unusually.pink/images/hackerman.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;The book, in my opinion, is &lt;em&gt;very&lt;/em&gt; well written. While I was familiar with most of the concepts covered, I think it was written in a way that makes the material approachable even for readers without much prior knowledge in the world of infosec. That being said, while there is a good bit of hand-holding in the introduction to Linux, I think there are some basic, assumed competencies in the world of computing. I don&amp;rsquo;t think that&amp;rsquo;s a fault; you really have to draw the line somewhere, and I think the authors did a fantastic job of making everything as approachable as possible.&lt;/p&gt;
&lt;p&gt;The book comes with a complete lab environment with virtual machines pre-configured to be exploitable in a fashion to demonstrate the concepts covered in each chapter of the book, giving readers the option to either read the book purely for information or to work through the labs and practice executing the material discussed. In my mind it&amp;rsquo;s essentially like a self-guided, DIY version of something like the excellent &lt;a href=&#34;https://www.mcafee.com/enterprise/en-us/services/foundstone-services.html&#34;&gt;Foundstone&lt;/a&gt; Ultimate Hacking class that I was fortunate enough to take a few years ago.&lt;/p&gt;
&lt;p&gt;If you&amp;rsquo;re already a skilled hacker, is the book going to enlighten you to new, next-level exploits? Definitely not. But if you&amp;rsquo;re a systems administrator who is responsible for the managing servers at your company, a SaaS admin responsible for identities, or a developer responsible for creating applications exposed to the Internet at large, it&amp;rsquo;ll give you a very solid baseline for making sure that your own systems aren&amp;rsquo;t vulnerable to the most egregious of issues. I personally found the open source intelligence gathering chapter &lt;em&gt;very&lt;/em&gt; useful; it covered techniques and services for determining the amount of information about your company and specific details regarding the employees that&amp;rsquo;s available to literally anyone with an interest in finding out more. It&amp;rsquo;s allowed me to work through setting up some scripts to automatically check on this and notify me when perhaps more information is leaking out than it should due to things like 3rd party breaches where users may have signed up with a company email address.&lt;/p&gt;
&lt;p&gt;Similarly, I think the book is also a good read for leadership-level people who may not need to know the technical details of how hacks are accomplished but need to be mindful of what&amp;rsquo;s possible and what their employees should be looking for when developing and administering systems. These readers likely don&amp;rsquo;t need to go through things like achieving the exploits themselves in the lab (though obviously it&amp;rsquo;s cool if they want to), but the book can serve as a nice reference for what the company&amp;rsquo;s employees &lt;em&gt;should&lt;/em&gt; be looking for when they decide to roll out a new service or application.&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>Idiot&#39;s Guide To Figuring Out How A Website Was Hacked</title>
      <link>https://unusually.pink/idiots-guide-to-figuring-out-how-a-website-was-hacked/</link>
      <pubDate>Wed, 18 Mar 2020 00:00:00 +0000</pubDate>
      
      <guid>https://unusually.pink/idiots-guide-to-figuring-out-how-a-website-was-hacked/</guid>
      <description>Full Disclosure: This won&amp;rsquo;t tell you exactly what was wrong with a website. This will just give you a pretty good, quick idea. I&amp;rsquo;m not in DFIR or even InfoSec. I&amp;rsquo;m just a sysadmin who has some familiarity with a decent number of systems. It&amp;rsquo;s also worth mentioning that I did all of these actions from my Linux machine. The same would be possible from macOS or from Windows 10 with the Windows Subsystem for Linux.</description>
      <content>&lt;p&gt;&lt;strong&gt;&lt;em&gt;Full Disclosure:&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;This won&amp;rsquo;t tell you exactly what was wrong with a website. This will just give you a pretty good, quick idea. I&amp;rsquo;m not in DFIR or even InfoSec. I&amp;rsquo;m just a sysadmin who has some familiarity with a decent number of systems. It&amp;rsquo;s also worth mentioning that I did all of these actions from my Linux machine. The same would be possible from macOS or from Windows 10 with the Windows Subsystem for Linux.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Last night, my good buddy &lt;a href=&#34;https://www.instagram.com/craftbrewgeek/&#34;&gt;Craft Brew Geek&lt;/a&gt; shot me a message because a website we both had something of an interest in (I won&amp;rsquo;t go into more specifics than that to protect the guilty&amp;hellip; I&amp;rsquo;ll just say that it doesn&amp;rsquo;t belong to either of us) had suddenly exhibited weird behavior. Navigating to the website, either via directly typing their URL into my browser or by searching for them on Google and clicking the link, took me &lt;em&gt;not&lt;/em&gt; to the expected website but to a &lt;strong&gt;super&lt;/strong&gt; shady online pharmacy; there&amp;rsquo;s not enough booze in the world to get me drunk enough to type my credit card information into this site. Since we&amp;rsquo;re all stuck at home under quarantine, though, I figured I&amp;rsquo;d kill a little time digging into what, exactly, was going on.&lt;/p&gt;
&lt;p&gt;The initial problem is that I navigate to &lt;code&gt;desiredsite.com&lt;/code&gt; and it takes me to &lt;code&gt;shadysite.com&lt;/code&gt; instead. A common way this type of thing happens without any degree of technical compromise is if someone allows their domain to expire rather than having it automatically renew. When that happens, it&amp;rsquo;s possible for an attacker to swoop in, buy the domain, and then change the DNS information to point to their desired site. It&amp;rsquo;s pretty uncommon since most DNS registrars will park domains for a month, giving the original owner time to renew. Failing that, they often go to auction rather than back into the pool. Additionally, under this scenario there would be no reason to redirect to &lt;code&gt;shadysite.com&lt;/code&gt;. Still, it doesn&amp;rsquo;t hurt to check the DNS history through something like &lt;a href=&#34;https://securitytrails.com/&#34;&gt;SecurityTrails&lt;/a&gt;. This showed the last DNS change was 3 months ago for the site in question; there&amp;rsquo;s no way the site had been redirected for 3 months so I could rule that out.&lt;/p&gt;
&lt;p&gt;My next thought was to see if the sites were on the same server. If they were, that would tell me the entire server was wrecked, receiving my request, and was configured to load a different site instead. This was easy enough through &lt;code&gt;dig&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;dig +short desiredsite.com. a
dig +short shadysite.com. a
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This gave me two different IP addresses. This tells me the sites aren&amp;rsquo;t hosted on the same server, which means that &lt;code&gt;desiredsite.com&lt;/code&gt; is &lt;em&gt;redirecting&lt;/em&gt; me to &lt;code&gt;shadysite.com&lt;/code&gt;. For that to be the case, I &lt;em&gt;have&lt;/em&gt; to be hitting &lt;code&gt;desiredsite.com&lt;/code&gt; first, but then I&amp;rsquo;m redirected before I see anything. I needed to see what was up with the site before being redirected. Scripts on the web are most commonly executed not on the server side, but locally in the browser. As a result, I used &lt;code&gt;wget&lt;/code&gt; to just try to snag the file living at &lt;code&gt;desiredsite.com&lt;/code&gt;, which for most websites will be &lt;code&gt;index.html&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;wget http://desiredsite.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This simply downloads the file to my local machine. Nothing is actually executing any scripts it might reference. Sure enough, this gives me an HTML file for &lt;code&gt;desiredsite.com&lt;/code&gt; I can open in a text editor. I figured JavaScript was likely being used to handle the redirect. To test this, I turned off JavaScript in Google Chrome and once again navigated to &lt;code&gt;http://desiredsite.com&lt;/code&gt;. This caused the expected website to load, albeit kind of broken since JavaScript wasn&amp;rsquo;t running.&lt;/p&gt;
&lt;p&gt;Diving back into the &lt;code&gt;index.html&lt;/code&gt; file, a quick search showed me that there were nearly 60 &lt;code&gt;.js&lt;/code&gt; files for JavaScript. Ick. JavaScript can be written to be fairly easy to consume if you&amp;rsquo;ve got a passing familiarity with computer programming, but &lt;em&gt;most&lt;/em&gt; JavaScript on the web is designed to be 1.) minified and 2.) obfuscated to make this nearly impossible. Seriously, this is what a typical JavaScript file looks like. Note how my editor is showcasing the fact that it&amp;rsquo;s all &lt;strong&gt;one line&lt;/strong&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://unusually.pink/images/IdiotsGuideToFiguringOutHowAWebsiteWasHacked_gross.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;Clearly trying to read through 60 files of that isn&amp;rsquo;t going to happen; this isn&amp;rsquo;t my job, I&amp;rsquo;m doing it for fun. However, I still had some options for trying to quickly look for something flagrant. I saved down local copies of all 60 JavaScript files in the same directory, and then navigated to that directory from my terminal. I then used &lt;code&gt;grep -R&lt;/code&gt; to recursively search through every JavaScript file at the same time.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;cd /path/to/javascript
grep -R &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;search term here&amp;#34;&lt;/span&gt; .
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;What did I search for? I started off by searching for &lt;code&gt;shadysite.com&lt;/code&gt;. No dice. Then I searched for the IP address I got for the site from my previous &lt;code&gt;dig&lt;/code&gt; command. Also no dice. I didn&amp;rsquo;t think it would be anything that overt, but it was worth a shot. I decided to look at the source code for &lt;code&gt;shadysite.com&lt;/code&gt; to see if there were any clues. I immediately noticed that the entire site was coded around the IP address for the site rather than the domain. For example, links in the source code of most sites are going to look like:&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://mydomain.com/folder/page.html&#34;&gt;http://mydomain.com/folder/page.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The links on this particular page were done like this:&lt;/p&gt;
&lt;p&gt;http://192.168.254.254/folder/page.html&lt;/p&gt;
&lt;p&gt;Obviously that &lt;em&gt;wasn&amp;rsquo;t&lt;/em&gt; the IP address in use, but you get the point. This tells me that, unsurprisingly, they run into a lot of problems with their domain getting shut down. So they design the site to be domain agnostic, buy a new domain when the old one is shuttered, and then point it to the same IP address they&amp;rsquo;ve been using. Some quick searches online showed me a few tools I could use to plug in an IP address and get a historical list of domains tied to that IP. I used &lt;a href=&#34;https://viewdns.info/reverseip/&#34;&gt;ViewDNS.info&lt;/a&gt;. This showed me 6 total domains that had been pointing to the same IIP address, one of which was what I saw now. I repeated my &lt;code&gt;grep&lt;/code&gt; search above with the others to see if there were any hits, but sadly there was still no luck.&lt;/p&gt;
&lt;p&gt;At this point, though, I still had a pretty good idea of what was happening. Out of the 60 JavaScript files referenced by the source code for &lt;code&gt;desiredsite.com&lt;/code&gt;, most of them were in a sub-directory for WordPress, including some directories that noted they were for WordPress plugins. Having looked at enough compromised websites over the past 15 years, it&amp;rsquo;s a definite trend that WordPress (and especially WordPress plugins) tend to be Swiss cheese. WordPress plugins are a frequent target for attackers, and most people &lt;em&gt;never&lt;/em&gt; think to update them. At this point, if I were determined to get to the bottom of things, it would be much quicker to just point some kind of vulnerability scanner like &lt;a href=&#34;https://www.tenable.com/products/nessus/nessus-professional&#34;&gt;Nessus&lt;/a&gt; at the site and just let it find the vulnerable plugin(s) rather than tracking them down through obfuscated JavaScript.&lt;/p&gt;
&lt;p&gt;All told, though, it was a fun exercise to dig into how the site was compromised and come away after only about 30 minutes of work with a pretty good guess.&lt;/p&gt;
</content>
    </item>
    
  </channel>
</rss>
